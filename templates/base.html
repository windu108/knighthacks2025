<!doctype html>
<html lang="en" data-bs-theme="dark">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}{% endblock %}</title>
    <!-- Bootstrap CSS link -->
    <!--<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">-->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/custom.css') }}">
  </head>
  <body>
    <nav class="navbar sticky-top bg-body-tertiary border-bottom border-primary border-3">
      
      <div class="container-fluid">
        <div class="col-4 justify-content-start">
          <a class="navbar-brand" href="{{ url_for('index') }}">Meeting</a>
        </div>
      </div>
    </nav>

    <div class="container mt-4">
      <!-- A block for child templates to fill with content -->
      {% block content %}{% endblock %}
      {% block scripts %}{% endblock %}
    </div>

    <div class="container">
      <h2 class="text-center mb-4"> Profile </h2>

      <!-- Username Input -->
      <div class="mb-3">
        <label for="nameInput" class="form-label">Name</label>
        <input type="text" class="form-control" id="nameInput" placeholder="Enter your name">
      </div>

      <!-- Password Input -->
      <div class="mb-3">
        <label for="passwordInput" class="form-label">Password</label>
        <input type="password" class="form-control" id="passwordInput" placeholder="Enter your password">
      </div>

      <!-- Output Box -->
      <div class="mt-4">
        <div class="box output-box">
          <h5>Output:</h5>
          <div id="outputText" class="mt-2 text-secondary">Waiting for input...</div>
        </div>
      </div>

      <!-- Button -->
      <div class="d-grid mt-4">
        <button id=submitBtn class="btn btn-primary">Submit</button>
      </div>

      <!-- Calendar -->
      <div class="container mt-5">
        <h3 class="text-center mb-4">Simple Availability Calendar</h3>

        <div class="table-responsive">
          <table class="table table-bordered text-center align-middle" id="calendarTable">
            <thead class="table-dark">
              <tr>
                <th>Time</th>
                <th>Mon</th>
                <th>Tue</th>
                <th>Wed</th>
                <th>Thu</th>
                <th>Fri</th>
                <th>Sat</th>
                <th>Sun</th>
              </tr>
            </thead>
            <tbody>
              <!-- We'll generate time slots dynamically with JS -->
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <script>
      //For the Input and output
      const submitBtn = document.getElementById('submitBtn');
      const userName = document.getElementById('nameInput');
      const password = document.getElementById('passwordInput');
      const outputText = document.getElementById('outputText');

      //When the button is pressed
      submitBtn.addEventListener('click', () => {
        //Grabs Data inside of the input boxes
        const user = userName.value.trim();
        const pw = password.value.trim();

        //forces user to type the data in properly
        if (user === "" || pw === "") {
          outputText.textContent = "⚠️ Your mom will be so disappointed! TYPE!";
          return;
        }

        // For now, just echo the input
        outputText.textContent = `Username:\n${user} Password:\n${pw}`;
        
        // Later: replace with a call to your backend or AI API
        // fetch('/api/suggest', { method: 'POST', body: JSON.stringify({ message: text }) })
        //   .then(res => res.json())
        //   .then(data => outputText.textContent = data.reply)
        //   .catch(() => outputText.textContent = "Error contacting AI");
      });
    </script>
    <script>
      //For the Calendar
      document.addEventListener("DOMContentLoaded", function () {
        const tbody = document.querySelector("#calendarTable tbody");

        // Generate time slots
        const startHour = 8;
        const endHour = 20;
        for (let hour = startHour; hour <= endHour; hour++) {
          const row = document.createElement("tr");
          const timeCell = document.createElement("td");
          const suffix = hour >= 12 ? "PM" : "AM";
          const displayHour = hour % 12 === 0 ? 12 : hour % 12;
          timeCell.textContent = `${displayHour}:00 ${suffix}`;
          row.appendChild(timeCell);

          for (let day = 0; day < 7; day++) {
            const cell = document.createElement("td");
            cell.classList.add("calendar-cell");
            cell.style.height = "40px";
            row.appendChild(cell);
          }

          tbody.appendChild(row);
        }

        // ---- Click & Drag Selection Logic ----
        let isMouseDown = false;
        let selecting = false; // true = selecting, false = deselecting

        document.addEventListener("mousedown", function (e) {
          if (e.target.classList.contains("calendar-cell")) {
            isMouseDown = true;
            selecting = !e.target.classList.contains("selected");
            e.target.classList.toggle("selected", selecting);
          }
        });

        document.addEventListener("mouseover", function (e) {
          if (isMouseDown && e.target.classList.contains("calendar-cell")) {
            e.target.classList.toggle("selected", selecting);
          }
        });

        document.addEventListener("mouseup", function () {
          isMouseDown = false;
        });

        // Prevent text selection while dragging
        document.addEventListener("dragstart", e => e.preventDefault());
      });
    </script>


    
    <!-- Bootstrap JS bundle (includes Popper for components like dropdowns) -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script> -->
    <script src="{{ url_for('node_modules', filename='bootstrap/dist/js/bootstrap.bundle.min.js') }}"></script>
  </body>
</html>
